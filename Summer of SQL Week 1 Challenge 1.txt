WITH TRANSACTION_TABLE AS(
SELECT SPLIT_PART(TRANSACTION_CODE, '-', 1) AS Bank,*,
   DAYNAME(TO_TIMESTAMP(TRANSACTION_DATE, 'DD/MM/YYYY HH24:MI:SS')) AS TRANSACTION_DATE,
    CASE 
        WHEN ONLINE_OR_IN_PERSON = 1 THEN 'Online'
        ELSE 'In-Person'
    END,
 
FROM PD2023_WK01)


SELECT BANK, SUM(VALUE)
FROM TRANSACTION_TABLE
GROUP BY BANK