WITH TRANSACTION_TABLE AS(
SELECT SPLIT_PART(TRANSACTION_CODE, '-', 1) AS Bank,*,
   DAYNAME(TO_TIMESTAMP(TRANSACTION_DATE, 'DD/MM/YYYY HH24:MI:SS')) AS TRANSACTION_DATE1,
    CASE 
        WHEN ONLINE_OR_IN_PERSON = 1 THEN 'Online'
        ELSE 'In-Person'
    END AS TYPE_OF_TRANSACTION,
 
FROM PD2023_WK01)

-- Challenge 1
--SELECT BANK, SUM(VALUE)
--FROM TRANSACTION_TABLE
--GROUP BY BANK

-- Challenge 2
--SELECT BANK, TYPE_OF_TRANSACTION, TRANSACTION_DATE1, SUM(VALUE)
--FROM TRANSACTION_TABLE
--GROUP BY BANK,TRANSACTION_DATE1,TYPE_OF_TRANSACTION

-- Challenge 3
--SELECT BANK, CUSTOMER_CODE, SUM(VALUE)
--FROM TRANSACTION_TABLE
--GROUP BY BANK,CUSTOMER_CODE